generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "mysql"
}

model Category {
  c_id     Int       @id @default(autoincrement())
  c_name   String    @unique @db.VarChar(50)
  products Product[]
}

model Product {
  p_id     Int       @id @default(autoincrement())
  p_name   String    @unique @db.VarChar(50)
  price    Decimal   @db.Decimal(10, 2)
  c_id     Int?
  category Category? @relation(fields: [c_id], references: [c_id], onUpdate: Cascade, onDelete: Restrict)
  stock    Stock?
  discount Discount?
}

model Stock {
  s_id     Int     @id @default(autoincrement())
  p_id     Int     @unique
  quantity Int     @default(0)
  product  Product @relation(fields: [p_id], references: [p_id], onUpdate: Cascade, onDelete: Cascade)
}

enum DiscountType {
  FLAT
  PERCENT
}

model Discount {
  d_id           Int             @id @default(autoincrement())
  p_id           Int             @unique
  d_type         DiscountType
  product        Product         @relation(fields: [p_id], references: [p_id], onUpdate: Cascade, onDelete: Cascade)
  discountValues DiscountValues?
}

model DiscountValues {
  d_id      Int      @id
  d_flat    Int?
  d_percent Decimal? @db.Decimal(5, 2)
  discount  Discount @relation(fields: [d_id], references: [d_id], onUpdate: Cascade, onDelete: Cascade)
}

model Users {
  userId    Int      @id @default(autoincrement())
  name      String   @db.VarChar(50)
  email     String   @unique @db.VarChar(255)
  password  String?  @db.VarChar(128)
  isDeleted Boolean? @default(false)
  TokenId   String?  @unique @db.VarChar(255)
  cart      Cart[]   @relation("UserCarts")
}

model Admin {
  adminId   Int      @id @default(autoincrement())
  name      String   @db.VarChar(50)
  email     String   @unique @db.VarChar(255)
  password  String?  @db.VarChar(128)
  isDeleted Boolean? @default(false)
  TokenId   String?  @unique @db.VarChar(255)
  cart      Cart[]   @relation("AdminCarts")
}

model Cart {
  c_id      Int      @id @default(autoincrement())
  userId    Int?
  user      Users?    @relation("UserCarts",fields:[userId],references:[userId])
  adminId   Int?
  admin     Admin?    @relation("AdminCarts",fields:[adminId],references:[adminId])
  p_id      Int
  p_name    String
  price     Decimal  @db.Decimal(10, 2)
  quantity  Int
  d_type    String
  d_value   Decimal  @db.Decimal(10, 2)
  t_price   Decimal  @db.Decimal(10, 2)
  d_price   Decimal  @db.Decimal(10, 2)
  createdAt DateTime @default(now())
}